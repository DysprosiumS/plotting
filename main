import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from seaborn import kdeplot

df = pd.read_excel('C:/Users/17.3 Active Systems/Desktop/Для работы/сил частицы/пересчет 2/mean.xlsx', sheet_name=1)

# Построение распределения (гистограмма + KDE)
plt.figure(figsize=(12, 8))

# Расчет статистик
data_column = df[df.columns[0]]
mean_val = data_column.mean()
std_val = data_column.std()
median_val = data_column.median()

# Гистограмма с KDE
plt.subplot(2, 2, 1)
sns.histplot(data=df, kde=True, bins=30, legend=True)
sns.kdeplot(data=df, x=df.columns[0], fill=True, alpha=0.1, color='green',  linewidth=2)

# Текст со статистиками
stats_text = f'''Статистики:
Среднее: {mean_val:.4f}
Медиана: {median_val:.4f}
Ст. откл.: {std_val:.4f}'''

plt.text(0.02, 0.98, stats_text,
         transform=plt.gca().transAxes,
         fontsize=8,
         verticalalignment='top',
         bbox=dict(boxstyle="round,pad=0.5", facecolor="white", alpha=0.9))

plt.title(f'Распределение (Гистограмма + KDE)')
plt.xlabel('Параметр')
plt.ylabel('Частота')
plt.grid(True, alpha=0.3)
plt.tight_layout()

plt.show()
